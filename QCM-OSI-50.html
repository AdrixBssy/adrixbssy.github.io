<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>QCM OSI & TCP/IP — 50 aléatoires </title>
  <style>
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; margin: 0; background:#0b1020; color:#e8ecff; }
    header { padding: 18px 16px; background: #111a33; border-bottom: 1px solid rgba(255,255,255,.08); position: sticky; top: 0; z-index: 10;}
    header h1 { margin: 0 0 8px 0; font-size: 18px; }
    header .row { display:flex; flex-wrap:wrap; gap:10px; align-items:center; }
    button { background:#2b5cff; color:white; border:0; padding:10px 12px; border-radius:10px; font-weight:600; cursor:pointer; }
    button.secondary { background:#26304f; }
    button:disabled { opacity:.55; cursor:not-allowed; }
    .wrap { max-width: 1000px; margin: 0 auto; padding: 16px; }
    .meta { display:flex; flex-wrap:wrap; gap:10px; align-items:center; color:#b9c2ff; font-size: 14px; }
    .pill { padding: 6px 10px; border-radius: 999px; background: rgba(255,255,255,.08); }
    .card { background: rgba(255,255,255,.06); border: 1px solid rgba(255,255,255,.08); border-radius: 16px; padding: 14px; margin: 12px 0; }
    .qtitle { margin:0 0 10px 0; font-size: 15px; }
    .choices { display:grid; gap:8px; }
    label.choice { display:flex; gap:10px; padding:10px; border-radius:12px; border:1px solid rgba(255,255,255,.10); background: rgba(0,0,0,.12); cursor:pointer; }
    .footerbar { display:flex; justify-content:space-between; margin: 14px 0; }
    .ok { outline: 2px solid rgba(0,255,150,.4); }
    .bad { outline: 2px solid rgba(255,80,80,.4); }
    .explain { font-size: 13px; margin-top: 8px; }
  </style>
</head>
<body>

<header>
  <h1>QCM OSI & TCP/IP (50 aléatoires)</h1>
  <div class="meta">
    <span class="pill" id="pillCount"></span>
    <span class="pill" id="pillScore">Score: —</span>
  </div>
  <div class="row">
    <button id="btnFinish">Corriger</button>
    <button id="btnNew" class="secondary">Nouveau QCM</button>
    <button id="btnReset" class="secondary">Effacer réponses</button>
  </div>
</header>

<div class="wrap">
  <div id="questions"></div>
  <div id="resultBox"></div>
</div>

<script>
// ===== Acronymes =====
const ACRONYMS = {
  "IP": "IP (Internet Protocol)",
  "TCP": "TCP (Transmission Control Protocol)",
  "UDP": "UDP (User Datagram Protocol)",
  "HTTP": "HTTP (HyperText Transfer Protocol)",
  "HTTPS": "HTTPS (HyperText Transfer Protocol Secure)",
  "DNS": "DNS (Domain Name System)",
  "FTP": "FTP (File Transfer Protocol)",
  "SSH": "SSH (Secure Shell)",
  "DHCP": "DHCP (Dynamic Host Configuration Protocol)",
  "ICMP": "ICMP (Internet Control Message Protocol)",
  "ARP": "ARP (Address Resolution Protocol)"
};

function expandAcronyms(text) {
  let result = text;
  for (const key in ACRONYMS) {
    result = result.replace(new RegExp(`\\b${key}\\b`, "g"), ACRONYMS[key]);
  }
  return result;
}

// ===== Utils =====
function shuffle(a){
  return a.sort(()=>Math.random()-0.5);
}

// ===== Banque =====
const questionBank = [];

function addQ(text, correct, wrongs){
  const choices = shuffle([correct, ...wrongs]).slice(0,4);
  questionBank.push({
    text: expandAcronyms(text),
    choices: choices.map(expandAcronyms),
    answer: correct
  });
}

// ===== Génération simple =====
addQ("Quel protocole traduit IP en MAC ?", "ARP", ["DNS","TCP","UDP"]);
addQ("Combien de couches OSI ?", "7", ["4","5","6"]);
addQ("Quel protocole web ?", "HTTP", ["FTP","DNS","ARP"]);
addQ("Quel protocole fiable ?", "TCP", ["UDP","IP","ICMP"]);

// duplication pour atteindre 200
while(questionBank.length < 200){
  const base = questionBank[questionBank.length % 4];
  questionBank.push(base);
}

// ===== Quiz =====
let questions = [];
let answers = [];

function newQuiz(){
  questions = shuffle([...questionBank]).slice(0,50);
  answers = new Array(50).fill(null);
  render();
}

function render(){
  const container = document.getElementById("questions");
  container.innerHTML = "";

  questions.forEach((q,i)=>{
    const div = document.createElement("div");
    div.className="card";
    div.innerHTML = `<b>${i+1}. ${q.text}</b>`;

    q.choices.forEach(c=>{
      const label = document.createElement("label");
      label.className="choice";
      label.innerHTML = `<input type="radio" name="q${i}"> ${c}`;
      label.onclick = ()=>answers[i]=c;
      div.appendChild(label);
    });

    container.appendChild(div);
  });

  document.getElementById("pillCount").textContent = "Questions: 50";
}

// ===== Correction =====
document.getElementById("btnFinish").onclick = ()=>{
  let score=0;
  questions.forEach((q,i)=>{
    if(answers[i]===q.answer) score++;
  });
  document.getElementById("pillScore").textContent = `Score: ${score}/50`;
};

document.getElementById("btnNew").onclick = newQuiz;
document.getElementById("btnReset").onclick = ()=>{answers.fill(null); render();};

// init
newQuiz();
</script>

</body>
</html>
